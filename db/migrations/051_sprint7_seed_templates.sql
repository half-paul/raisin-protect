-- Migration: 051_sprint7_seed_templates.sql
-- Description: PBC (Prepared by Client) request templates — 80 templates across SOC2/PCI/ISO/GDPR (Sprint 7)
-- Created: 2026-02-21
-- Sprint: 7 — Audit Hub
-- Idempotent: ON CONFLICT DO NOTHING on all inserts
--
-- Templates stored in a dedicated table for reuse across audits.
-- Each template can be cloned into actual audit_requests via the API.

-- ============================================================================
-- PBC REQUEST TEMPLATES TABLE
-- ============================================================================

CREATE TABLE IF NOT EXISTS audit_request_templates (
    id                  UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    framework           VARCHAR(50) NOT NULL,
    audit_type          audit_type NOT NULL,
    reference_number    VARCHAR(50) NOT NULL,
    title               VARCHAR(500) NOT NULL,
    description         TEXT NOT NULL,
    priority            audit_request_priority NOT NULL DEFAULT 'medium',
    tags                TEXT[] NOT NULL DEFAULT '{}',
    created_at          TIMESTAMPTZ NOT NULL DEFAULT NOW(),

    CONSTRAINT uq_audit_request_template_ref UNIQUE (framework, audit_type, reference_number)
);

CREATE INDEX IF NOT EXISTS idx_audit_request_templates_framework ON audit_request_templates (framework);
CREATE INDEX IF NOT EXISTS idx_audit_request_templates_type ON audit_request_templates (audit_type);

COMMENT ON TABLE audit_request_templates IS 'PBC (Prepared by Client) request templates for common audit types';

-- ============================================================================
-- SOC 2 TYPE II PBC TEMPLATES (25)
-- ============================================================================

INSERT INTO audit_request_templates (id, framework, audit_type, reference_number, title, description, priority, tags) VALUES
    ('a6000000-0000-0000-0001-000000000001', 'soc2', 'soc2_type2', 'PBC-SOC2-001',
     'Organization Chart and Reporting Structure',
     'Provide current organizational chart showing reporting lines, IT/security team structure, and governance committees responsible for security oversight.',
     'medium', ARRAY['governance', 'cc1']),
    ('a6000000-0000-0000-0001-000000000002', 'soc2', 'soc2_type2', 'PBC-SOC2-002',
     'Information Security Policy (Current, Approved)',
     'Provide the current board- or management-approved information security policy. Include approval date, version history, and evidence of annual review.',
     'high', ARRAY['policy', 'cc1', 'cc5']),
    ('a6000000-0000-0000-0001-000000000003', 'soc2', 'soc2_type2', 'PBC-SOC2-003',
     'Access Control Procedures and User Provisioning',
     'Document access control procedures including user provisioning, de-provisioning, role-based access model, and approval workflows for access requests.',
     'high', ARRAY['access-control', 'cc6']),
    ('a6000000-0000-0000-0001-000000000004', 'soc2', 'soc2_type2', 'PBC-SOC2-004',
     'Change Management Procedures and Recent Change Logs',
     'Provide change management policy and procedures. Include change logs for the audit period showing approval, testing, and rollback documentation.',
     'high', ARRAY['change-management', 'cc8']),
    ('a6000000-0000-0000-0001-000000000005', 'soc2', 'soc2_type2', 'PBC-SOC2-005',
     'Incident Response Plan and Recent Incident Reports',
     'Provide the incident response plan including escalation procedures, communication templates, and reports for any security incidents during the audit period.',
     'high', ARRAY['incident-response', 'cc7']),
    ('a6000000-0000-0000-0001-000000000006', 'soc2', 'soc2_type2', 'PBC-SOC2-006',
     'Business Continuity and Disaster Recovery Plans',
     'Provide BCP/DRP documentation including RTO/RPO targets, test results from the most recent DR test, and lessons learned.',
     'medium', ARRAY['bc-dr', 'a1']),
    ('a6000000-0000-0000-0001-000000000007', 'soc2', 'soc2_type2', 'PBC-SOC2-007',
     'Vendor Management Policy and Vendor Risk Assessments',
     'Provide third-party vendor management policy and risk assessments for critical vendors. Include due diligence records and SOC report reviews.',
     'medium', ARRAY['vendor', 'cc9']),
    ('a6000000-0000-0000-0001-000000000008', 'soc2', 'soc2_type2', 'PBC-SOC2-008',
     'Employee Onboarding/Offboarding Procedures',
     'Document HR procedures for onboarding (background checks, training, access provisioning) and offboarding (access revocation, equipment return, exit interview).',
     'medium', ARRAY['hr', 'cc1', 'cc6']),
    ('a6000000-0000-0000-0001-000000000009', 'soc2', 'soc2_type2', 'PBC-SOC2-009',
     'Security Awareness Training Records (Last 12 Months)',
     'Provide evidence of security awareness training completion for all employees during the audit period. Include completion rates, topics covered, and phishing simulation results.',
     'medium', ARRAY['training', 'cc1']),
    ('a6000000-0000-0000-0001-000000000010', 'soc2', 'soc2_type2', 'PBC-SOC2-010',
     'Network Diagram Showing Data Flows',
     'Provide current network architecture diagram showing production environment, data flows between systems, encryption in transit/at rest indicators, and security boundaries.',
     'high', ARRAY['network', 'cc6', 'cc7']),
    ('a6000000-0000-0000-0001-000000000011', 'soc2', 'soc2_type2', 'PBC-SOC2-011',
     'Encryption Standards and Key Management Procedures',
     'Document encryption standards (algorithms, key lengths) for data at rest and in transit. Include key management lifecycle procedures and rotation schedules.',
     'medium', ARRAY['encryption', 'cc6', 'c1']),
    ('a6000000-0000-0000-0001-000000000012', 'soc2', 'soc2_type2', 'PBC-SOC2-012',
     'Logical Access Reviews (Last 4 Quarters)',
     'Provide quarterly user access review reports for all critical systems. Include reviewer sign-offs, exceptions identified, and remediation actions taken.',
     'high', ARRAY['access-review', 'cc6']),
    ('a6000000-0000-0000-0001-000000000013', 'soc2', 'soc2_type2', 'PBC-SOC2-013',
     'System Monitoring and Alerting Configuration',
     'Document monitoring tools, alerting thresholds, escalation procedures, and evidence of alert response during the audit period.',
     'medium', ARRAY['monitoring', 'cc7']),
    ('a6000000-0000-0000-0001-000000000014', 'soc2', 'soc2_type2', 'PBC-SOC2-014',
     'Vulnerability Scan Reports (Last 12 Months)',
     'Provide internal and external vulnerability scan reports for the audit period. Include remediation tracking and trend analysis.',
     'high', ARRAY['vulnerability', 'cc7']),
    ('a6000000-0000-0000-0001-000000000015', 'soc2', 'soc2_type2', 'PBC-SOC2-015',
     'Penetration Test Report (Most Recent)',
     'Provide the most recent penetration test report (internal and external). Include scope, findings, severity ratings, and remediation status.',
     'high', ARRAY['pentest', 'cc7']),
    ('a6000000-0000-0000-0001-000000000016', 'soc2', 'soc2_type2', 'PBC-SOC2-016',
     'Board/Management Meeting Minutes re: Security Governance',
     'Provide meeting minutes or summaries from board/management meetings where security governance topics were discussed during the audit period.',
     'medium', ARRAY['governance', 'cc1']),
    ('a6000000-0000-0000-0001-000000000017', 'soc2', 'soc2_type2', 'PBC-SOC2-017',
     'Risk Assessment Documentation (Most Recent)',
     'Provide the most recent enterprise risk assessment including methodology, identified risks, risk ratings, treatment plans, and risk acceptance documentation.',
     'high', ARRAY['risk', 'cc3']),
    ('a6000000-0000-0000-0001-000000000018', 'soc2', 'soc2_type2', 'PBC-SOC2-018',
     'Data Classification Policy and Procedures',
     'Provide data classification policy defining sensitivity levels, handling requirements per level, and evidence of classification applied to key data stores.',
     'medium', ARRAY['data', 'c1', 'cc6']),
    ('a6000000-0000-0000-0001-000000000019', 'soc2', 'soc2_type2', 'PBC-SOC2-019',
     'Physical Security Controls Documentation',
     'Document physical security controls for data centers and offices. Include badge access logs, visitor logs, CCTV coverage, and environmental controls.',
     'medium', ARRAY['physical', 'cc6']),
    ('a6000000-0000-0000-0001-000000000020', 'soc2', 'soc2_type2', 'PBC-SOC2-020',
     'Backup and Recovery Test Results',
     'Provide backup configuration documentation and results from the most recent backup/recovery tests. Include RTO/RPO achievement metrics.',
     'medium', ARRAY['backup', 'a1']),
    ('a6000000-0000-0000-0001-000000000021', 'soc2', 'soc2_type2', 'PBC-SOC2-021',
     'SLA/Uptime Reports for Critical Systems',
     'Provide availability/uptime reports for critical systems during the audit period. Include SLA targets vs actual performance.',
     'medium', ARRAY['availability', 'a1']),
    ('a6000000-0000-0000-0001-000000000022', 'soc2', 'soc2_type2', 'PBC-SOC2-022',
     'Third-Party SOC Reports for Subservice Providers',
     'Provide SOC 1/SOC 2 reports from subservice organizations. Include management assessment of complementary user entity controls (CUECs).',
     'medium', ARRAY['vendor', 'cc9']),
    ('a6000000-0000-0000-0001-000000000023', 'soc2', 'soc2_type2', 'PBC-SOC2-023',
     'Employee Background Check Procedures',
     'Document background check procedures for new hires. Include evidence of background checks completed during the audit period.',
     'low', ARRAY['hr', 'cc1']),
    ('a6000000-0000-0000-0001-000000000024', 'soc2', 'soc2_type2', 'PBC-SOC2-024',
     'Firewall and IDS/IPS Configuration Standards',
     'Provide firewall rule sets, IDS/IPS configuration standards, and evidence of periodic review/cleanup of firewall rules.',
     'medium', ARRAY['network', 'cc6', 'cc7']),
    ('a6000000-0000-0000-0001-000000000025', 'soc2', 'soc2_type2', 'PBC-SOC2-025',
     'Exception/Waiver Documentation',
     'Provide documentation for all security control exceptions or waivers granted during the audit period. Include approval, risk acceptance, and expiration dates.',
     'medium', ARRAY['governance', 'cc3'])
ON CONFLICT (framework, audit_type, reference_number) DO NOTHING;

-- ============================================================================
-- PCI DSS v4.0.1 ROC TEMPLATES (25)
-- ============================================================================

INSERT INTO audit_request_templates (id, framework, audit_type, reference_number, title, description, priority, tags) VALUES
    ('a6000000-0000-0000-0002-000000000001', 'pci_dss', 'pci_dss_roc', 'PBC-PCI-001',
     'Network Segmentation Documentation and Validation Results',
     'Provide network segmentation architecture documentation and results from the most recent segmentation validation/penetration test.',
     'critical', ARRAY['network', 'req1']),
    ('a6000000-0000-0000-0002-000000000002', 'pci_dss', 'pci_dss_roc', 'PBC-PCI-002',
     'Cardholder Data Flow Diagram',
     'Provide current cardholder data flow diagrams showing all flows of cardholder data across systems, networks, and applications.',
     'critical', ARRAY['data-flow', 'req1']),
    ('a6000000-0000-0000-0002-000000000003', 'pci_dss', 'pci_dss_roc', 'PBC-PCI-003',
     'CDE Asset Inventory',
     'Provide complete inventory of all systems, applications, and network devices within the cardholder data environment (CDE).',
     'high', ARRAY['inventory', 'req2']),
    ('a6000000-0000-0000-0002-000000000004', 'pci_dss', 'pci_dss_roc', 'PBC-PCI-004',
     'Firewall/Router Configuration Standards',
     'Provide firewall and router configuration standards and evidence of current compliance. Include rule review documentation.',
     'high', ARRAY['firewall', 'req1']),
    ('a6000000-0000-0000-0002-000000000005', 'pci_dss', 'pci_dss_roc', 'PBC-PCI-005',
     'Wireless Network Scanning Results',
     'Provide results from quarterly wireless scans detecting unauthorized wireless access points in and around the CDE.',
     'medium', ARRAY['wireless', 'req11']),
    ('a6000000-0000-0000-0002-000000000006', 'pci_dss', 'pci_dss_roc', 'PBC-PCI-006',
     'Encryption Key Management Procedures',
     'Provide cryptographic key management procedures including generation, distribution, storage, rotation, and destruction. Include key custodian records.',
     'high', ARRAY['encryption', 'req3', 'req4']),
    ('a6000000-0000-0000-0002-000000000007', 'pci_dss', 'pci_dss_roc', 'PBC-PCI-007',
     'Anti-Malware Deployment Evidence',
     'Provide evidence of anti-malware deployment on all CDE systems. Include configuration, update schedules, and scan logs.',
     'high', ARRAY['malware', 'req5']),
    ('a6000000-0000-0000-0002-000000000008', 'pci_dss', 'pci_dss_roc', 'PBC-PCI-008',
     'Critical Security Patch Installation Records (Last 6 Months)',
     'Provide evidence of critical security patch deployment within 30 days of release for all CDE systems. Include patching timeline and exceptions.',
     'high', ARRAY['patching', 'req6']),
    ('a6000000-0000-0000-0002-000000000009', 'pci_dss', 'pci_dss_roc', 'PBC-PCI-009',
     'Secure SDLC Documentation',
     'Provide secure software development lifecycle documentation including code review procedures, testing requirements, and developer training records.',
     'high', ARRAY['sdlc', 'req6']),
    ('a6000000-0000-0000-0002-000000000010', 'pci_dss', 'pci_dss_roc', 'PBC-PCI-010',
     'Payment Page Script Inventory (Req 6.4.3)',
     'Provide complete inventory of all scripts loaded on payment pages. Include justification, integrity verification method, and authorization for each script.',
     'critical', ARRAY['scripts', 'req6.4.3']),
    ('a6000000-0000-0000-0002-000000000011', 'pci_dss', 'pci_dss_roc', 'PBC-PCI-011',
     'Role-Based Access Control Matrix for CDE',
     'Provide RBAC matrix for CDE systems showing roles, assigned privileges, and business justification for each access level.',
     'high', ARRAY['access', 'req7']),
    ('a6000000-0000-0000-0002-000000000012', 'pci_dss', 'pci_dss_roc', 'PBC-PCI-012',
     'Multi-Factor Authentication Configuration Evidence',
     'Provide evidence of MFA implementation for all administrative access to CDE and all remote access. Include configuration screenshots and user enrollment.',
     'critical', ARRAY['mfa', 'req8']),
    ('a6000000-0000-0000-0002-000000000013', 'pci_dss', 'pci_dss_roc', 'PBC-PCI-013',
     'Physical Access Logs for Data Center (Last 90 Days)',
     'Provide physical access logs for facilities housing CDE systems for the last 90 days. Include badge reader logs and visitor logs.',
     'medium', ARRAY['physical', 'req9']),
    ('a6000000-0000-0000-0002-000000000014', 'pci_dss', 'pci_dss_roc', 'PBC-PCI-014',
     'Audit Log Configuration and Samples (Req 10)',
     'Provide audit log configuration for CDE systems and sample logs demonstrating required log fields. Include log retention evidence and tamper protection.',
     'high', ARRAY['logging', 'req10']),
    ('a6000000-0000-0000-0002-000000000015', 'pci_dss', 'pci_dss_roc', 'PBC-PCI-015',
     'Internal Vulnerability Scan Results (Last 4 Quarters)',
     'Provide internal vulnerability scan results for each quarter of the audit period. Include remediation tracking for high/critical vulnerabilities.',
     'high', ARRAY['vulnerability', 'req11']),
    ('a6000000-0000-0000-0002-000000000016', 'pci_dss', 'pci_dss_roc', 'PBC-PCI-016',
     'External ASV Scan Results (Last 4 Quarters)',
     'Provide Approved Scanning Vendor (ASV) scan results for each quarter. Include passing scan reports and remediation for failed scans.',
     'high', ARRAY['asv', 'req11']),
    ('a6000000-0000-0000-0002-000000000017', 'pci_dss', 'pci_dss_roc', 'PBC-PCI-017',
     'Penetration Test Results (Internal and External)',
     'Provide internal and external penetration test results from the most recent test. Include application-layer testing for CDE web applications.',
     'critical', ARRAY['pentest', 'req11']),
    ('a6000000-0000-0000-0002-000000000018', 'pci_dss', 'pci_dss_roc', 'PBC-PCI-018',
     'Service Provider Responsibility Matrix',
     'Provide responsibility matrix for all third-party service providers with access to cardholder data. Include compliance attestation status.',
     'high', ARRAY['vendor', 'req12']),
    ('a6000000-0000-0000-0002-000000000019', 'pci_dss', 'pci_dss_roc', 'PBC-PCI-019',
     'Incident Response Plan and Test Results',
     'Provide the PCI-specific incident response plan and results from the most recent IR plan test/tabletop exercise.',
     'high', ARRAY['incident-response', 'req12']),
    ('a6000000-0000-0000-0002-000000000020', 'pci_dss', 'pci_dss_roc', 'PBC-PCI-020',
     'Security Awareness Training Completion Records',
     'Provide evidence that all personnel with access to CDE have completed security awareness training. Include training content relevant to PCI DSS.',
     'medium', ARRAY['training', 'req12']),
    ('a6000000-0000-0000-0002-000000000021', 'pci_dss', 'pci_dss_roc', 'PBC-PCI-021',
     'PCI DSS Policy Suite (12 Requirement Families)',
     'Provide the complete PCI DSS policy suite covering all 12 requirement families. Include evidence of annual review and management approval.',
     'high', ARRAY['policy', 'req12']),
    ('a6000000-0000-0000-0002-000000000022', 'pci_dss', 'pci_dss_roc', 'PBC-PCI-022',
     'Targeted Risk Analysis Documentation',
     'Provide targeted risk analysis documents for requirements where PCI DSS v4.0.1 allows customized approach based on risk analysis (e.g., password policies, scan frequency).',
     'high', ARRAY['risk', 'req12']),
    ('a6000000-0000-0000-0002-000000000023', 'pci_dss', 'pci_dss_roc', 'PBC-PCI-023',
     'Compensating Control Documentation',
     'For any compensating controls in use, provide the compensating control worksheet including risk addressed, original control intent, and testing procedures.',
     'medium', ARRAY['compensating', 'req12']),
    ('a6000000-0000-0000-0002-000000000024', 'pci_dss', 'pci_dss_roc', 'PBC-PCI-024',
     'File Integrity Monitoring Configuration and Alerts',
     'Provide FIM configuration for critical CDE system files. Include sample alerts and evidence of alert review procedures.',
     'high', ARRAY['fim', 'req11']),
    ('a6000000-0000-0000-0002-000000000025', 'pci_dss', 'pci_dss_roc', 'PBC-PCI-025',
     'Change Detection Mechanism Evidence (Req 11.6.1)',
     'Provide evidence of change/tamper detection mechanism for payment pages. Include configuration, alert samples, and response procedures.',
     'critical', ARRAY['tamper-detection', 'req11.6.1'])
ON CONFLICT (framework, audit_type, reference_number) DO NOTHING;

-- ============================================================================
-- ISO 27001 CERTIFICATION TEMPLATES (15)
-- ============================================================================

INSERT INTO audit_request_templates (id, framework, audit_type, reference_number, title, description, priority, tags) VALUES
    ('a6000000-0000-0000-0003-000000000001', 'iso27001', 'iso27001_certification', 'PBC-ISO-001',
     'ISMS Scope Statement',
     'Provide the defined scope of the Information Security Management System including boundaries, applicability, and interfaces.',
     'critical', ARRAY['isms', 'clause4']),
    ('a6000000-0000-0000-0003-000000000002', 'iso27001', 'iso27001_certification', 'PBC-ISO-002',
     'Statement of Applicability (SoA)',
     'Provide the Statement of Applicability listing all Annex A controls with justification for inclusion/exclusion and implementation status.',
     'critical', ARRAY['soa', 'clause6']),
    ('a6000000-0000-0000-0003-000000000003', 'iso27001', 'iso27001_certification', 'PBC-ISO-003',
     'Risk Assessment Methodology',
     'Provide the documented risk assessment methodology including risk identification, analysis, evaluation criteria, and risk acceptance thresholds.',
     'high', ARRAY['risk', 'clause6']),
    ('a6000000-0000-0000-0003-000000000004', 'iso27001', 'iso27001_certification', 'PBC-ISO-004',
     'Risk Treatment Plan',
     'Provide the risk treatment plan showing selected treatment options, responsible owners, timelines, and status of implementation for each identified risk.',
     'high', ARRAY['risk-treatment', 'clause6']),
    ('a6000000-0000-0000-0003-000000000005', 'iso27001', 'iso27001_certification', 'PBC-ISO-005',
     'Information Security Policy',
     'Provide the top-level information security policy approved by top management. Include evidence of communication to all relevant parties.',
     'high', ARRAY['policy', 'clause5']),
    ('a6000000-0000-0000-0003-000000000006', 'iso27001', 'iso27001_certification', 'PBC-ISO-006',
     'Asset Inventory and Classification',
     'Provide the information asset inventory with classification levels, asset owners, and acceptable use rules per the asset management policy.',
     'medium', ARRAY['assets', 'a8']),
    ('a6000000-0000-0000-0003-000000000007', 'iso27001', 'iso27001_certification', 'PBC-ISO-007',
     'Access Control Policy and Procedures',
     'Provide access control policy and supporting procedures covering user registration, privilege management, and password/authentication standards.',
     'high', ARRAY['access', 'a9']),
    ('a6000000-0000-0000-0003-000000000008', 'iso27001', 'iso27001_certification', 'PBC-ISO-008',
     'Cryptography Policy',
     'Provide the cryptography policy covering encryption standards, key management procedures, and approved algorithms for data protection.',
     'medium', ARRAY['crypto', 'a10']),
    ('a6000000-0000-0000-0003-000000000009', 'iso27001', 'iso27001_certification', 'PBC-ISO-009',
     'Physical Security Procedures',
     'Provide physical security procedures for offices, data centers, and remote facilities. Include access logs, environmental controls, and equipment security.',
     'medium', ARRAY['physical', 'a11']),
    ('a6000000-0000-0000-0003-000000000010', 'iso27001', 'iso27001_certification', 'PBC-ISO-010',
     'Operations Security Procedures',
     'Provide operations security procedures covering change management, capacity management, malware protection, backup, logging, and vulnerability management.',
     'high', ARRAY['operations', 'a12']),
    ('a6000000-0000-0000-0003-000000000011', 'iso27001', 'iso27001_certification', 'PBC-ISO-011',
     'Communications Security Procedures',
     'Provide network security management and information transfer procedures. Include network segmentation documentation and secure communication standards.',
     'medium', ARRAY['communications', 'a13']),
    ('a6000000-0000-0000-0003-000000000012', 'iso27001', 'iso27001_certification', 'PBC-ISO-012',
     'Supplier Relationship Procedures',
     'Provide supplier information security procedures, supplier assessment records, and monitoring of supplier security performance.',
     'medium', ARRAY['supplier', 'a15']),
    ('a6000000-0000-0000-0003-000000000013', 'iso27001', 'iso27001_certification', 'PBC-ISO-013',
     'Incident Management Procedures',
     'Provide information security incident management procedures including reporting, assessment, response, and lessons learned documentation.',
     'high', ARRAY['incident', 'a16']),
    ('a6000000-0000-0000-0003-000000000014', 'iso27001', 'iso27001_certification', 'PBC-ISO-014',
     'Business Continuity Procedures',
     'Provide business continuity management procedures including BIA, continuity plans, testing results, and recovery objectives.',
     'medium', ARRAY['continuity', 'a17']),
    ('a6000000-0000-0000-0003-000000000015', 'iso27001', 'iso27001_certification', 'PBC-ISO-015',
     'Compliance Procedures and Legal Register',
     'Provide compliance procedures and the legal/regulatory/contractual requirements register. Include evidence of periodic compliance reviews.',
     'medium', ARRAY['compliance', 'a18'])
ON CONFLICT (framework, audit_type, reference_number) DO NOTHING;

-- ============================================================================
-- GDPR DPIA TEMPLATES (15)
-- ============================================================================

INSERT INTO audit_request_templates (id, framework, audit_type, reference_number, title, description, priority, tags) VALUES
    ('a6000000-0000-0000-0004-000000000001', 'gdpr', 'gdpr_dpia', 'PBC-GDPR-001',
     'Data Processing Register (Article 30)',
     'Provide the record of processing activities covering all personal data processing operations including purposes, categories, recipients, transfers, and retention periods.',
     'critical', ARRAY['ropa', 'art30']),
    ('a6000000-0000-0000-0004-000000000002', 'gdpr', 'gdpr_dpia', 'PBC-GDPR-002',
     'Privacy Impact Assessment Methodology',
     'Provide the DPIA methodology including criteria for when DPIAs are required, assessment procedures, and integration with project management lifecycle.',
     'high', ARRAY['dpia', 'art35']),
    ('a6000000-0000-0000-0004-000000000003', 'gdpr', 'gdpr_dpia', 'PBC-GDPR-003',
     'Data Subject Rights Procedures',
     'Provide procedures for handling data subject access requests (DSAR), right to erasure, portability, rectification, and objection. Include response time tracking.',
     'high', ARRAY['dsar', 'art15-22']),
    ('a6000000-0000-0000-0004-000000000004', 'gdpr', 'gdpr_dpia', 'PBC-GDPR-004',
     'Consent Management Procedures',
     'Provide consent management procedures including how consent is obtained, recorded, managed, and withdrawn. Include technical implementation details.',
     'high', ARRAY['consent', 'art7']),
    ('a6000000-0000-0000-0004-000000000005', 'gdpr', 'gdpr_dpia', 'PBC-GDPR-005',
     'Data Breach Notification Procedures',
     'Provide data breach detection, assessment, and notification procedures. Include evidence of any breaches reported to supervisory authorities within 72 hours.',
     'critical', ARRAY['breach', 'art33', 'art34']),
    ('a6000000-0000-0000-0004-000000000006', 'gdpr', 'gdpr_dpia', 'PBC-GDPR-006',
     'Data Protection Officer Appointment Documentation',
     'Provide DPO appointment documentation, role description, reporting structure, and evidence of DPO independence and adequate resourcing.',
     'medium', ARRAY['dpo', 'art37-39']),
    ('a6000000-0000-0000-0004-000000000007', 'gdpr', 'gdpr_dpia', 'PBC-GDPR-007',
     'International Data Transfer Mechanisms',
     'Provide documentation of all international data transfers including transfer mechanisms (SCCs, BCRs, adequacy decisions), TIA results, and supplementary measures.',
     'critical', ARRAY['transfers', 'art44-49']),
    ('a6000000-0000-0000-0004-000000000008', 'gdpr', 'gdpr_dpia', 'PBC-GDPR-008',
     'Data Retention Schedule',
     'Provide the data retention schedule including retention periods per data category, legal basis, and evidence of periodic data purging/anonymization.',
     'high', ARRAY['retention', 'art5']),
    ('a6000000-0000-0000-0004-000000000009', 'gdpr', 'gdpr_dpia', 'PBC-GDPR-009',
     'Privacy by Design Evidence',
     'Provide evidence of data protection by design and by default implementation in systems and processes. Include privacy-enhancing technologies deployed.',
     'medium', ARRAY['pbd', 'art25']),
    ('a6000000-0000-0000-0004-000000000010', 'gdpr', 'gdpr_dpia', 'PBC-GDPR-010',
     'Processor Agreements (Article 28)',
     'Provide data processing agreements with all processors and sub-processors. Include evidence of processor compliance monitoring and audit rights.',
     'high', ARRAY['processor', 'art28']),
    ('a6000000-0000-0000-0004-000000000011', 'gdpr', 'gdpr_dpia', 'PBC-GDPR-011',
     'Legitimate Interest Assessments',
     'Provide legitimate interest assessments (LIAs) for all processing activities relying on legitimate interest as the legal basis.',
     'medium', ARRAY['lia', 'art6']),
    ('a6000000-0000-0000-0004-000000000012', 'gdpr', 'gdpr_dpia', 'PBC-GDPR-012',
     'Privacy Notices and Transparency Documentation',
     'Provide all privacy notices (website, employee, customer) and evidence they meet GDPR transparency requirements. Include version history.',
     'high', ARRAY['transparency', 'art13', 'art14']),
    ('a6000000-0000-0000-0004-000000000013', 'gdpr', 'gdpr_dpia', 'PBC-GDPR-013',
     'Cookie Consent Implementation Evidence',
     'Provide evidence of cookie consent implementation including consent banner, categories, opt-in mechanism, and records of consent per the ePrivacy Directive.',
     'medium', ARRAY['cookies', 'eprivacy']),
    ('a6000000-0000-0000-0004-000000000014', 'gdpr', 'gdpr_dpia', 'PBC-GDPR-014',
     'Employee Privacy Training Records',
     'Provide evidence of data protection awareness training for all employees who process personal data. Include completion records and training content.',
     'medium', ARRAY['training', 'art39']),
    ('a6000000-0000-0000-0004-000000000015', 'gdpr', 'gdpr_dpia', 'PBC-GDPR-015',
     'Supervisory Authority Correspondence',
     'Provide records of any correspondence with data protection supervisory authorities including consultations, complaints, and regulatory inquiries.',
     'low', ARRAY['authority', 'art36'])
ON CONFLICT (framework, audit_type, reference_number) DO NOTHING;
